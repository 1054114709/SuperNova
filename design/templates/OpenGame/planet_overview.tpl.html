<!-- DEFINE $OVERVIEW = true -->
<script type="text/javascript" xmlns="http://www.w3.org/1999/html" src="js/sn_ajax_send_fleet.js?{C_var_db_update}"></script>
<script type="text/javascript">
  var MT_SPY = {D_MT_SPY};
  var MT_COLONIZE = {D_MT_COLONIZE};
  var MT_RECYCLE = {D_MT_RECYCLE};
  var MT_MISSILE = {D_MT_MISSILE};
  var uni_galaxy = "{PLANET_GALAXY}";
  var uni_system = "{PLANET_SYSTEM}";
</script>

<script type="text/javascript">
  jQuery("#density_type").change(function(){
    selected = jQuery("#density_type option:selected");
    $("#transmute_button").button({disabled: parseInt(selected.attr("rest")) <= 0 || selected.attr("current") == '1'});
    $("#transmutation_cost").html(selected.attr("html")).removeClass().addClass(selected.attr("html_class"));
  });

  $(function() {
    $( "#dialog-rename-planet" ).dialog({
      autoOpen: false,
      resizable: false,
      height: 100,
      // width: 330,
      modal: true,
      buttons: {
        "{L_ov_rename}": function() {
          $("#dialog-rename-planet-form").submit();
          $( this ).dialog( "close" );
        },
        "{L_sys_cancel}": function() {
          $( this ).dialog( "close" );
        }
      }
    });
  });
</script>

<div id="dialog-rename-planet" title="{ov_planet_rename_dialog_title}" style="display: none; background-color: #344566;">
  <form action="overview.php" method="POST" id="dialog-rename-planet-form" style="margin: 10px;">
    <label for="planet_new_name">{L_ov_new_name}</label>
    <input type="text" name="new_name" id="planet_new_name" size=20 maxlength=20 value="{PLANET_NAME}" />
    <input type="hidden" name="rename" value="1" />
  </form>
</div>

<br />

<table align="center">
  <tr>
    <th valign=top class="tr">
      <!-- IF NEW_MESSAGES || NEW_LEVEL_MINER || NEW_LEVEL_RAID -->
        <table width="522">
          <!-- IF NEW_MESSAGES > 0 -->
            <tr><th colspan=2><a href=messages.php>
              {L_ov_you_have}
              <!-- IF NEW_MESSAGES == 1 -->
                {L_ov_new_message}
              <!-- ELSE -->
                {NEW_MESSAGES} {L_ov_new_messages}
              <!-- ENDIF -->
            </a></th></tr>
          <!-- ENDIF -->

          <!-- IF NEW_LEVEL_MINER -->
            <tr><th colspan=2><a href=officer.php>{L_ov_rpg_new_level_miner}</a></th></tr>
          <!-- ENDIF -->

          <!-- IF NEW_LEVEL_RAID -->
            <tr><th colspan=2><a href=officer.php>{L_ov_rpg_new_level_raid}</a></th></tr>
          <!-- ENDIF -->
        </table>
      <!-- ENDIF -->

      <table width="522">
        <tr>
          <th colspan=5 nowrap class="c_c">
            <table class="markup" width="100%">
              <tr>
                <th class="c_l" nowrap>
                  <a href="galaxy.php?mode=0&galaxy={PLANET_GALAXY}&system={PLANET_SYSTEM}" class="link">[{PLANET_GALAXY}:{PLANET_SYSTEM}:{PLANET_PLANET}] {PLANET_TYPE_TEXT} "{PLANET_NAME}"</a>
                </th>
                <th class="c_r" nowrap width="11em">
                  <input type="button" name="rename" value="{L_ov_rename}" onclick="$('#dialog-rename-planet').dialog('open');"/>
                </th>
                <th class="c_r" nowrap width="11em">
                  <button  go="" mode="manage">
                    <span class="positive">{L_ov_manage}</span>
                  </button>
                </th>
              </tr>
            </table>
          </th>
        </tr>

        <!-- IF GATE_LEVEL -->
          <tr>
            <th class="c_c" colspan="2">{L_tech[D_STRUC_MOON_GATE]}</th>
            <th class="c_c" colspan="3">
              <a href="jumpgate.php">
                <!-- IF GATE_JUMP_REST_TIME -->
                  {L_ov_gate_time_left} <span  id="gate_jump_time" class="error"></span>
                  <script type="text/javascript"><!--
                    sn_timers.unshift({id: 'gate_jump_time', type: TIMER_BUILD_QUE_V1, options: {
                      msg_done: '{L_gate_ready}',
                      que: [
                        ['1', '', {GATE_JUMP_REST_TIME}, '1']
                      ]
                    }});
                  // --></script>
                <!-- ELSE -->
                  <span class="ok">{L_gate_ready}</span>
                <!-- ENDIF -->
              </a>
            </th>
          </tr>
        <!-- ENDIF -->

        <tr>
          <td class="c_c" width="11em" rowspan="5">
            <!-- DEFINE $PLANET_ID = '{PLANET_ID}' -->
            <!-- INCLUDE planet_governor -->
          </td>

          <th colspan="4" style="padding: 0 2px;">
            <div class="ov_planet_fill_bar">
              <!-- IF PLANET_FILL >= 100 -->
                <!-- DEFINE $BAR_COLOR = 'negative_bg' -->
              <!-- ELSEIF PLANET_FILL >= 80 -->
                <!-- DEFINE $BAR_COLOR = 'neutral_bg' -->
              <!-- ELSE -->
                <!-- DEFINE $BAR_COLOR = 'positive_bg' -->
              <!-- ENDIF -->
              <div class="left_top {$BAR_COLOR}" style="height:100%; width: {PLANET_FILL_BAR}%;">&nbsp;</div>
              <div class="left_top fill_parent va_m">{L_buildings_on_planet} {planet_field_current}/{planet_field_max} ({PLANET_FILL}%)</div>
            </div>
            <!-- IF PLANET_TYPE == 1 -->
              <!-- IF SECTOR_CAN_BUY -->
                <a href="overview.php?sector_buy=1" class="positive link">{L_sys_sector_buy} {L_sys_for} {SECTOR_COST_TEXT} {L_sys_dark_matter_sh}</a>
              <!-- ELSE -->
                <span class="negative">{L_sys_sector_buy} {L_sys_for} {SECTOR_COST_TEXT} {L_sys_dark_matter_sh}</span>
              <!-- ENDIF -->
            <!-- ENDIF -->
          </th>
        </tr>

        <tr>
          <th colspan="4" id="fleetstatusrow">{L_orb}: {L_sys_metal}: {metal_debris} / {L_sys_crystal}: {crystal_debris}
            <!-- IF PLANET_RECYCLERS -->
              <!--<br><span id="ov_recycle" style="cursor: pointer" onclick="doit(MT_RECYCLE, {PLANET_PLANET}, {PLANET_TYPE});">[ {L_type_mission[8]} ]</span>-->
              <br><button id="ov_recycle" style="cursor: pointer" onclick="doit(MT_RECYCLE, {PLANET_PLANET}, {PLANET_TYPE});"<!-- IF ! PLANET_DEBRIS --> disabled="disabled"<!-- ENDIF -->><span>[ {L_type_mission[8]} ]</span></button>
              <table id="fleetstatustable" cellspacing="0" cellpadding="0"></table>
            <!-- ENDIF -->
          </th>
        </tr>
        <tr>
          <th colspan="2">{L_Diameter}&nbsp;{planet_diameter}&nbsp;{L_km}</th>
          <th colspan="2">
            {L_sys_planet_density}:&nbsp;{planet_density}&nbsp;{L_sys_planet_density_units}
          </th>
        </tr>
        <tr>
          <th colspan="4">{L_Temperature}&nbsp;({L_min_avg_max}):&nbsp;{planet_temp_min}&deg;C&nbsp;/&nbsp;{planet_temp_avg}&deg;C&nbsp;/&nbsp;{planet_temp_max}&deg;C</th>
        </tr>

        <!-- IF PLANET_TYPE == 1 -->
        <tr>
          <th colspan="4" nowrap>
            <form action="overview.php" method="POST">
              <div class="icons icon-info link" style="display: inline-block; vertical-align: middle;" onclick="document.location='infos.php?gid={D_UNIT_PLANET_DENSITY}'"></div> {L_ov_core_type_current} "{PLANET_CORE_TEXT}"<br/>
              <div style="display: inline-block;">
                <label for="density_type">{L_ov_core_change_to}</label>
                <select name="density_type" id="density_type">
                  <!-- BEGIN densities -->
                  <option value="{densities.ID}" rest="{densities.REST}" html="{densities.COST_TEXT}" html_class="{densities.COST_TEXT_CLASS}"<!-- IF PLANET_DENSITY_INDEX == densities.ID --> selected current="1"<!-- ENDIF -->>{densities.TEXT}</option>
                  <!-- END densities -->
                </select>
              </div>
              <div style="display: inline-block; margin-left: 10px;">
                <button type="submit" id="transmute_button" name="transmute" value="transmute" disabled="disabled">
                  {L_sys_change}
                  {L_sys_for} <span id="transmutation_cost" class="zero">0</span> {L_sys_dark_matter_sh}
                </button>

                <script type="text/javascript">
                  jQuery("#density_type").change(function(){
                    selected = jQuery("#density_type option:selected");
                    $("#transmute_button").button({disabled: parseInt(selected.attr("rest")) <= 0 || selected.attr("current") == '1'});
                    $("#transmutation_cost").html(selected.attr("html")).removeClass().addClass(selected.attr("html_class"));
                  });
                </script>
              </div>
            </form>
          </th>
        </tr>
        <!-- ENDIF -->

        <tr><td colspan=5 class="c">{L_Planet_menu}</td></tr>
        <!-- BEGIN ques -->
          <tr>
            <th width=100 height=33%>
              <!-- IF ques.LENGTH -->
                <div>{L_sys_total_time}</div>
                <div id="ov_{ques.ID}_total" style="color: red"></div>
                <div id="ov_{ques.ID}_finish" style="color: yellow"></div>
                <div id="ov_{ques.ID}"></div>
                <!-- DEFINE $QUE_ID = '{ques.ID}' -->
                <!-- INCLUDE eco_queue -->
              <!-- ELSE -->
                {ques.NAME}<br>
              <!-- ENDIF -->
                <!--<div id="ov_{ques.ID}_timer" style="color: lime" class="ov_{ques.ID}_timer_0"></div>-->
            </th>
            <th colspan=4 id="ov_{ques.ID}_que">
              {L_eco_que_empty}
            </th>
          </tr>
        <!-- END ques -->

        <!-- INCLUDE planet_resources -->
      </table>

      <!-- INCLUDE planet_fleet_list -->
    </th>

    <th valign=top class="tr">
      <table border="0" cellspacing=0 cellpadding=0 width="200">
        <!-- INCLUDE planet_list -->
      </table>
    </th>
  </tr>

</table>

<div id="admin_message"></div>

<script type="text/javascript">
//  jQuery(document).bind("ready", function() {
//    // send requests
//    jQuery.post("scheduler.php", {rating: jQuery(this).html()}, function(xml) {
//      // format result
//      var result = [ jQuery("message", xml).text() ];
//      // output result
//      jQuery("#admin_message").html(result.join(""));
//    } );
//  });
</script>

<!-- NAVBAR START -->

<!-- IF GAME_BLITZ_REGISTER && ! GAME_BLITZ -->
<!--<div class="c_c"><input type="button" value="{L_sys_blitz_global_button}" onclick="sn_redirect('{D_SN_ROOT_VIRTUAL}blitz_register.php');"/></div>-->
<!-- ENDIF -->

<table cellpadding="3" cellspacing="0" class="header c_c" id="navbar"><tbody>
  <!-- IF HALLOWEEN -->
  <tr>
    <td class="c_r markup">
      <div class="navbar-container" id="navbar-halloween">
        <button onclick="sn_redirect('{D_SN_ROOT_VIRTUAL}index.php?page=halloween');">
          Cколько вкусняшек уже собрали?
        </button>
        <button onclick="sn_redirect('{D_SN_ROOT_VIRTUAL}index.php?page=halloween_kids');">
          Кто собрал все вкусняшки?
        </button>
      </div>
    </td>
  </tr>
  <!-- ENDIF -->
  <!-- IF GAME_BLITZ_REGISTER && ! GAME_BLITZ -->
  <tr>
    <td class="c_r markup">
      <button onclick="sn_redirect('{D_SN_ROOT_VIRTUAL}blitz_register.php');" id="navbar-blitz-button">
        {L_sys_blitz_global_button}:
        <span class="<!-- IF BLITZ_REGISTER_OPEN -->positive<!-- ELSEIF BLITZ_REGISTER_CLOSED -->negative<!-- ELSEIF BLITZ_REGISTER_SHOW_LOGIN -->zero<!-- ELSEIF BLITZ_REGISTER_DISCLOSURE_NAMES --><!-- ENDIF -->">
          {GAME_BLITZ_REGISTER_TEXT} ({C_game_blitz_register_users})
        </span>
      </button>
    </td>
  </tr>
  <!-- ENDIF -->
  <tr>
    <td class="c_l noborder">
      <div class="navbar-container">
        <div>
          <select size="1" onchange="changePlanet(this);" id="navbar_planet_select">
            <!-- BEGIN topnav_planets -->
            <option{topnav_planets.SELECTED} value="{topnav_planets.ID}">{topnav_planets.COORDS}&nbsp;{topnav_planets.TYPE_TEXT}&nbsp;{topnav_planets.NAME}
            <!-- END topnav_planets -->
          </select>
        </div>

        <div>{L_top_online}&nbsp;[{USERS_ONLINE}/{USERS_TOTAL}]</div>
      </div>
    </td>
  </tr>

  <tr>
    <th class="c_l noborder">
      <div class="navbar-container" id="navbar-container-time">
        <div class="c_c navbar-container-time-item">
          <span class="ok">{L_time_local}: <span id="top_time">{TIME_TEXT_LOCAL}</span></span><br />
          {L_time_server}: <span id="top_time_server">{TIME_TEXT}</span>
        </div>

        <div class="c_c navbar-container-time-item">
          <button id="font_minus">Шрифт -</button>
          <button id="font_normal">Норма</button>
          <button id="font_plus">Шрифт +</button>
        </div>
      </div>
    </th>
  </tr>

  <tr>
    <td>
      <div class="navbar-container" id="navbar-container-button">
        <!-- IF ! GAME_RESEARCH_DISABLED && ! PLAYER_OPTION_NAVBAR_DISABLE_RESEARCH -->

          <!-- DEFINE $QUE_ID = '{QUE_RESEARCH}' -->
          <!-- INCLUDE eco_queue -->
          <!-- IF PLAYER_OPTION_NAVBAR_RESEARCH_WIDE -->
            <!-- DEFINE $NAVBAR_BUTTON_RESEARCH_CLASS = 'wide' -->
          <!-- ENDIF -->
          <div class="navbar_button {$NAVBAR_BUTTON_RESEARCH_CLASS}">
            <a href="buildings.php?mode={D_QUE_RESEARCH}">
              <!-- IF PLAYER_OPTION_NAVBAR_RESEARCH_WIDE -->
              <img class="navbar_button_image" src="{I_navbar_research_wide}" alt="{L_Research}" title="{L_Research}" />
              <!-- ELSE -->
              <img class="navbar_button_image" src="{I_navbar_research}" alt="{L_Research}" title="{L_Research}" />
              <!-- ENDIF -->
              <!-- IF $QUE_NOT_EMPTY -->
                <span class="a50 navbar_button_que">
                    <div class="bld_que_total">
                      <div class="bld_que_total_time_text topnav_{$QUE_ID}_hide_on_complete">{L_que_slot_length}&nbsp;<span id="topnav_{$QUE_ID}_slots"></span></div>

                      <div class="bld_que_total_bar topnav_{$QUE_ID}_hide_on_complete">
                        <div id="topnav_{$QUE_ID}_progress_bar" class="bld_que_total_progress_bar"></div>
                        <div id="topnav_{$QUE_ID}_total" class="bld_que_total_timer"></div>
                      </div>
                      <div id="topnav_{$QUE_ID}"></div>

                      <div class="que_slot_time_container que_item_0 topnav_{$QUE_ID}_hide_on_complete">
                        <div class="que_unit_time que_unit_progress_bar topnav_{$QUE_ID}_unit_bar_0"></div>
                        <div class="que_unit_time topnav_{$QUE_ID}_timer_0 a50"></div>
                      </div>

                      <div id="topnav_{$QUE_ID}_que" class="hide"></div>
                    </div>
                </span>
              <!-- ELSE -->
                <span class="a50 navbar-container-button-que-empty">
                  {L_eco_que_empty}
                </span>
              <!-- ENDIF -->
            </a>
          </div>
        <!-- ENDIF -->

        <!-- IF ! PLAYER_OPTION_NAVBAR_DISABLE_PLANET -->

        <!-- DEFINE $QUE_ID = '{QUE_STRUCTURES}' -->
        <!-- INCLUDE eco_queue -->
        <div class="navbar_button">
          <a href="overview.php">
            <img class="navbar_button_image" src="{I_[TOPNAV_CURRENT_PLANET_IMAGE]}" alt="{TOPNAV_CURRENT_PLANET_NAME}" title="{TOPNAV_CURRENT_PLANET_NAME}">

            <!-- IF $QUE_NOT_EMPTY -->
                <span class="a50 navbar_button_que" >
                  <div class="bld_que_total">
                    <div class="bld_que_total_time_text topnav_{$QUE_ID}_hide_on_complete">{L_que_slot_length}&nbsp;<span id="topnav_{$QUE_ID}_slots"></span></div>

                    <div class="bld_que_total_bar topnav_{$QUE_ID}_hide_on_complete">
                      <div id="topnav_{$QUE_ID}_progress_bar" class="bld_que_total_progress_bar"></div>
                      <div id="topnav_{$QUE_ID}_total" class="bld_que_total_timer"></div>
                    </div>
                    <div id="topnav_{$QUE_ID}"></div>

                    <div class="que_slot_time_container que_item_0 topnav_{$QUE_ID}_hide_on_complete">
                      <div class="que_unit_time que_unit_progress_bar topnav_{$QUE_ID}_unit_bar_0"></div>
                      <div class="que_unit_time topnav_{$QUE_ID}_timer_0 a50"></div>
                    </div>


                    <div id="topnav_{$QUE_ID}_que" class="hide"></div>
                  </div>
                </span>
            <!-- ELSE -->
                <span class="a50 navbar-container-button-que-empty">
                  {L_eco_que_empty}
                </span>

              <span id="topnav_colonies_counter_total" class="a50 posRB w100">
                <span id='topnav_colonies_counter'>{TOPNAV_COLONIES_CURRENT}</span>/{TOPNAV_COLONIES_MAX}
              </span>
            <!-- ENDIF -->
          </a>
        </div>
        <!-- ENDIF -->

        <!-- IF ! PLAYER_OPTION_NAVBAR_DISABLE_HANGAR && ! GAME_HANGAR_DISABLED -->

        <!-- DEFINE $QUE_ID = '{SUBQUE_FLEET}' -->
        <!-- INCLUDE eco_queue -->
        <div class="navbar_button">
          <a href="buildings.php?mode={D_SUBQUE_FLEET}">
            <img class="navbar_button_image" src="{I_navbar_hangar}" alt="{L_Shipyard}" title="{L_Shipyard}" />
            <!-- IF $QUE_NOT_EMPTY -->
                <span class="a50 navbar_button_que" >
                  <div class="bld_que_total">
                    <div class="bld_que_total_time_text topnav_{$QUE_ID}_hide_on_complete">{L_que_slot_length}&nbsp;<span id="topnav_{$QUE_ID}_slots"></span></div>

                    <div class="bld_que_total_bar topnav_{$QUE_ID}_hide_on_complete">
                      <div id="topnav_{$QUE_ID}_progress_bar" class="bld_que_total_progress_bar"></div>
                      <div id="topnav_{$QUE_ID}_total" class="bld_que_total_timer"></div>
                    </div>
                    <div id="topnav_{$QUE_ID}"></div>

                    <div class="que_slot_time_container que_item_0 topnav_{$QUE_ID}_hide_on_complete">
                      <div class="que_unit_time que_unit_progress_bar topnav_{$QUE_ID}_unit_bar_0"></div>
                      <div class="que_unit_time topnav_{$QUE_ID}_timer_0 a50"></div>
                    </div>


                    <div id="topnav_{$QUE_ID}_que" class="hide"></div>
                  </div>
                </span>
            <!-- ELSE -->
                <span class="a50 navbar-container-button-que-empty">
                  {L_eco_que_empty}
                </span>
            <!-- ENDIF -->
          </a>
        </div>
        <!-- ENDIF -->

        <!-- IF ! PLAYER_OPTION_NAVBAR_DISABLE_EXPEDITIONS -->
        <div class="navbar_button">
          <a href="fleet.php">
            <img class="navbar_button_image" src="{I_navbar_expedition}" alt="{L_sys_expeditions}" title="{L_sys_expeditions}">
              <span id="topnav_expedition_counter_total" class="a50 posRB w100">
                <span id='topnav_expedition_counter'>{TOPNAV_EXPEDITIONS_FLYING}</span>/{TOPNAV_EXPEDITIONS_TOTAL}
              </span>
          </a>
        </div>
        <!-- ENDIF -->

        <!-- IF ! PLAYER_OPTION_NAVBAR_DISABLE_FLYING_FLEETS -->
        <div class="navbar_button">
          <a href="flying_fleets.php">
            <img class="navbar_button_image" src="{I_navbar_fleet_own}" alt="{L_sys_fleets}" title="{L_sys_fleets}">
              <span id="topnav_fleet_counter_total" class="a50 posRB w100">
                <span id='topnav_fleet_counter'>{TOPNAV_FLEETS_FLYING}</span>/{TOPNAV_FLEETS_TOTAL}
              </span>
          </a>
        </div>
        <!-- ENDIF -->

        <!-- IF ! PLAYER_OPTION_NAVBAR_DISABLE_QUESTS && ! GAME_QUESTS_DISABLED -->
        <div class="navbar_button">
          <a href="quest.php">
            <img class="navbar_button_image" src="{I_navbar_quest}" alt="{L_qst_quests}" title="{L_qst_quests}">
              <span class="a50 posRB w100">
                {TOPNAV_QUEST_COMPLETE}/{C_quest_total}
              </span>
          </a>
        </div>
        <!-- ENDIF -->

        <div class="navbar_button">
          <a href="messages.php">
            <img class="navbar_button_image" src="{I_navbar_mail}" alt="{L_Message}" title="{L_Message}">
            <div class="posRB">
              <!-- IF TOPNAV_MESSAGES_ALL --><span class="blink" duration="2000">[&nbsp;{TOPNAV_MESSAGES_ALL}&nbsp;]</span><!-- ELSE -->0<!-- ENDIF -->
            </div>
          </a>
          <!-- IF TOPNAV_MESSAGES_PLAYER -->
          <a href="messages.php?mode=show&message_class={D_MSG_TYPE_PLAYER}">
            <span class="posLT"><span class="mnl_joueur">[&nbsp;{TOPNAV_MESSAGES_PLAYER}&nbsp;]</span></span>
          </a>
          <!-- ENDIF -->
          <!-- IF TOPNAV_MESSAGES_ADMIN -->
          <a href="messages.php?mode=show&message_class={D_MSG_TYPE_ADMIN}">
            <span class="posLB"><span class="msg_admin">[&nbsp;{TOPNAV_MESSAGES_ADMIN}&nbsp;]</span></span>
          </a>
          <!-- ENDIF -->
          <!-- IF TOPNAV_MESSAGES_ALLIANCE && ! TOPNAV_ALLY -->
          <a href="messages.php?mode=show&message_class={D_MSG_TYPE_ALLIANCE}">
            <span class="posRT"><span class="mnl_alliance">[&nbsp;{TOPNAV_MESSAGES_ALLIANCE}&nbsp;]</span></span>
          </a>
          <!-- ENDIF -->
        </div>

        <div class="navbar_button">
          <a href="dark_matter.php">
            <img class="navbar_button_image" src="{I_navbar_dark_matter}" alt="{L_sys_dark_matter}" title="{L_sys_dark_matter}">
            <!-- IF TOPNAV_METAMATTER -->
            <span id="navbar_button_dm_mm" class="a50 metamatter posRB">{TOPNAV_METAMATTER_TEXT}</span>
            <span id="navbar_button_dm_dm" class="a50 dark_matter posRB">{TOPNAV_DARK_MATTER_PLAIN_TEXT}</span>
            <span id="navbar_button_dm_plus" class="a50 ok posLB">+</span>
            <!-- DEFINE $NAVBAR_DEBIT_LINE_CLASS = 'navbar_button_dm_debit_line' -->
            <!-- ENDIF -->
            <span class="a50 ok posRB {$NAVBAR_DEBIT_LINE_CLASS}">{TOPNAV_DARK_MATTER_TEXT}</span>
          </a>
        </div>

        <!-- IF ! PLAYER_OPTION_NAVBAR_DISABLE_META_MATTER && TOPNAV_PAYMENT -->
        <div class="navbar_button">
          <a href="metamatter.php">
            <img class="navbar_button_image" src="{I_navbar_metamatter}" alt="{L_sys_metamatte}" title="{L_sys_metamatter}">
            <span class="a50 posRB metamatter">{TOPNAV_METAMATTER_TEXT}</span>
          </a>
        </div>
        <!-- ENDIF -->
      </div>
    </td>
  </tr>
</tbody></table>

<!-- IF SN_RENDER_NAVBAR_PLANET -->
<table align="center" class="border_image_small" id="navbar_resources">
  <!-- INCLUDE planet_resources -->
</table>
<!-- ENDIF -->
<div id="navbar_refresh" class="button_pseudo" onclick="document.location.reload(true);">{L_topnav_refresh_page}</div>

<!-- IF .announces && GAME_NEWS_OVERVIEW -->
<table width=519 id="fresh_news_table" align="center" class="border_image_small">
  <tr>
    <th class="c_c">
      {L_news_fresh}
      <img class="fr pointer" onclick="jQuery.post('announce.php?only_hide_news=1');jQuery('#fresh_news_table').css('display', 'none');" src="{I_r1}" alt="{L_sys_close}" title="{L_sys_close}" style="width: 1.454545em; height: 1.454545em;" />
    </th>
  </tr>
  <!-- INCLUDE news_list -->
  <tr>
    <th class="c_c">
      <a class="link" href="announce.php">{L_news_all}</a>
    </th>
  </tr>
</table>
<!-- ENDIF -->

<!-- IF .note -->
<table width=519 id="note_table" align="center">
  <tr>
    <th colspan=2 class="c_c">
      <a class="link" href="notes.php">{L_sys_notes}</a>
    </th>
  </tr>
  <!-- INCLUDE note_list -->
</table>
<!-- ENDIF -->

<script type="text/javascript">
  sn_inframe ? $('#navbar_refresh').css('display', 'block') : false;

  function changePlanet(obj) {
    var pathAdd = 'cp=' + obj.options[obj.selectedIndex].value + ('{TOPNAV_MODE}' ? '&mode={TOPNAV_MODE}' : '');
    regexp=/\?page\=(.*)/i;
    var parsed = regexp.exec(window.location.href);
    if(parsed) {
      // pathAdd = parsed[0] + '&' + pathAdd;
      pathAdd = parsed[0].replace(/\&cp=\d*/i, '').replace(/\&mode=\d*/i, '') + '&' + pathAdd;
    } else {
      pathAdd = '?' + pathAdd;
    }
    // alert(pathAdd);
    window.location.href = window.location.pathname + pathAdd;
  }

  sn_timers.unshift({
    'id': 'top_time_server',
    'type': TIMER_CLOCK_REALTIME,
    'options': {
      'format': 3,
      'delta': -timeDiff
    }
  });

  sn_timers.unshift({
    'id': 'top_time',
    'type': TIMER_CLOCK_REALTIME,
    'options': {
      'format': 3,
      'delta': 0
    }
  });

  <!-- IF .flying_fleets -->
  sn_timers.unshift({
    'id': 'topnav_fleet_counter',
    'type': TIMER_EVENT_QUE,
    'options': {
      'msg_done': '0',
      'changed': true,
      'que': [<!-- BEGIN flying_fleets -->
        [parseInt('{flying_fleets.TIME}'), '{flying_fleets.TEXT}', '{flying_fleets.HINT}'],
      <!-- END flying_fleets -->]
    }
  });
  <!-- ENDIF -->

  <!-- IF .flying_expeditions -->
  sn_timers.unshift({
    'id': 'topnav_expedition_counter',
    'type': TIMER_EVENT_QUE,
    'options': {
      'msg_done': '0',
      'changed': true,
      'que': [<!-- BEGIN flying_expeditions -->
        [parseInt('{flying_expeditions.TIME}'), '{flying_expeditions.TEXT}', '{flying_expeditions.HINT}'],
      <!-- END flying_expeditions -->]
    }
  });
  <!-- ENDIF -->
</script>
